# AstrBot è‡ªä¸»å­¦ä¹ æ’ä»¶ Next-Gen ğŸ§ âœ¨

> **âš ï¸ ä½¿ç”¨å‰å¿…è¯»ï¼šè¯·åŠ¡å¿…å…ˆæ‰‹åŠ¨å¤‡ä»½äººæ ¼åˆ°æœ¬åœ°ï¼Œä»¥é˜²å‡ºç°BUGå¯¼è‡´äººæ ¼æ··ä¹±**

<div align="center">

[![Version](https://img.shields.io/badge/version-Next--1.0.0-blue.svg)](https://github.com/NickCharlie/astrbot_plugin_self_learning)
[![License](https://img.shields.io/badge/license-GPLv3-green.svg)](LICENSE)
[![AstrBot](https://img.shields.io/badge/AstrBot-%3E%3D4.0.0-orange.svg)](https://github.com/Soulter/AstrBot)
[![Python](https://img.shields.io/badge/python-3.8%2B-blue.svg)](https://www.python.org/)

**è®©ä½ çš„ AI èŠå¤©æœºå™¨äººåƒçœŸäººä¸€æ ·å­¦ä¹ ã€æ€è€ƒå’Œå¯¹è¯**

[åŠŸèƒ½ç‰¹æ€§](#-æ ¸å¿ƒç‰¹æ€§) â€¢ [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹) â€¢ [æ¶æ„è®¾è®¡](#-æŠ€æœ¯æ¶æ„) â€¢ [æ–‡æ¡£](#-æ–‡æ¡£å¯¼èˆª) â€¢ [è´¡çŒ®æŒ‡å—](#-è´¡çŒ®æŒ‡å—)

</div>

---

## ğŸŒŸ é¡¹ç›®æ¦‚è¿°

AstrBot æ™ºèƒ½è‡ªä¸»å­¦ä¹ æ’ä»¶æ˜¯ä¸€ä¸ªå…¨åŠŸèƒ½ AI è‡ªä¸»å­¦ä¹  èŠå¤©æ‹ŸäººåŒ– è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡å®æ—¶æ¶ˆæ¯æ•è·ã€å¤šç»´åº¦æ•°æ®åˆ†æã€è¡¨è¾¾æ¨¡å¼å­¦ä¹ å’ŒåŠ¨æ€äººæ ¼ä¼˜åŒ–ï¼Œè®©èŠå¤©æœºå™¨äººèƒ½å¤Ÿï¼š

- ğŸ“– **å­¦ä¹ ç‰¹å®šç”¨æˆ·çš„å¯¹è¯é£æ ¼** - è‡ªåŠ¨æ¨¡ä»¿å­¦ä¹ å¯¹è±¡çš„è¡¨è¾¾æ–¹å¼
- ğŸ¯ **æ™ºèƒ½é»‘è¯ç†è§£ç³»ç»Ÿ** - è‡ªåŠ¨å­¦ä¹ ç¾¤ç»„ç‰¹å®šç”¨è¯­ï¼Œé¿å…è¯¯è§£
- â¤ï¸ **ç®¡ç†ç¤¾äº¤å…³ç³»å’Œå¥½æ„Ÿåº¦** - è¿½è¸ªç”¨æˆ·äº’åŠ¨ï¼ŒåŠ¨æ€è°ƒæ•´å›å¤ç­–ç•¥
- ğŸ­ **è‡ªé€‚åº”äººæ ¼æ¼”åŒ–** - æ ¹æ®å­¦ä¹ æˆæœæ™ºèƒ½æ›´æ–° AI äººæ ¼è®¾å®š
- ğŸŒ **å¯è§†åŒ–ç®¡ç†ç•Œé¢** - é€šè¿‡ WebUI å®æ—¶ç›‘æ§å­¦ä¹ è¿›åº¦å’Œæ•ˆæœ


### ç¤¾åŒºäº¤æµ
- QQ ç¾¤: **1021544792**
  (ChatPlus æ’ä»¶ç”¨æˆ· + æœ¬æ’ä»¶ç”¨æˆ·)
- åé¦ˆ Bug å’Œä½¿ç”¨é—®é¢˜

### ğŸ¤ æ¨èæ­é…

**[ç¾¤èŠå¢å¼ºæ’ä»¶ (Group Chat Plus)](https://github.com/Him666233/astrbot_plugin_group_chat_plus)**

ä¸¤è€…å®Œç¾äº’è¡¥ï¼š
- æœ¬æ’ä»¶è´Ÿè´£ **AIå­¦ä¹ ä¸äººæ ¼ä¼˜åŒ–**
- ç¾¤èŠå¢å¼ºæ’ä»¶è´Ÿè´£ **æ™ºèƒ½å›å¤å†³ç­–ä¸è¯»ç©ºæ°”èƒ½åŠ›**

é…åˆä½¿ç”¨å¯ä»¥è®©ä½ çš„ Bot æ—¢æœ‰å­¦ä¹ èƒ½åŠ›ï¼Œåˆæœ‰"è¯»ç©ºæ°”"çš„ç¤¾äº¤æ™ºèƒ½ï¼

---

## ğŸ’¡ æ ¸å¿ƒç‰¹æ€§

### ğŸ¯ æ™ºèƒ½å­¦ä¹ ç³»ç»Ÿ

#### 1. è¡¨è¾¾æ¨¡å¼å­¦ä¹ 
```
åœºæ™¯ â†’ è¡¨è¾¾æ¨¡å¼ æ˜ å°„
"å½“éœ€è¦è¡¨è¾¾è‚¯å®šæ—¶" â†’ "å¯ä»¥ä½¿ç”¨'ç¡®å®å¦‚æ­¤å‘¢'è¿™æ ·çš„è¡¨è¾¾"
```
- è‡ªåŠ¨è¯†åˆ«å¯¹è¯ä¸­çš„åœºæ™¯-è¡¨è¾¾å…³ç³»
- 15å¤©æ—¶é—´è¡°å‡æœºåˆ¶ï¼Œä¼˜å…ˆä¿ç•™é«˜è´¨é‡æ¨¡å¼
- Few-Shot å¯¹è¯ç¤ºä¾‹ç”Ÿæˆï¼Œæå‡æ¨¡ä»¿å‡†ç¡®åº¦

#### 2. è®°å¿†å›¾ç³»ç»Ÿ
- åŸºäº NetworkX æ„å»ºçŸ¥è¯†å…³è”ç½‘ç»œ
- è‡ªåŠ¨æå–å®ä½“å’Œå…³ç³»ï¼Œå½¢æˆé•¿æœŸè®°å¿†
- æ”¯æŒè®°å¿†æ£€ç´¢å’ŒçŸ¥è¯†æ¨ç†

#### 3. ç¤¾äº¤å…³ç³»åˆ†æ
- å®æ—¶è¿½è¸ªç”¨æˆ·äº’åŠ¨å…³ç³»
- å¯è§†åŒ–ç¤¾äº¤ç½‘ç»œå›¾è°±
- å¥½æ„Ÿåº¦ç³»ç»Ÿï¼ˆå•ç”¨æˆ·ä¸Šé™100åˆ†ï¼Œæ€»åˆ†250åˆ†ï¼‰
- åŠ¨æ€æƒ…ç»ªç®¡ç†ï¼ˆ10ç§æƒ…ç»ªç±»å‹ï¼‰

#### 4. é»‘è¯æŒ–æ˜ä¸ç†è§£
```python
# è‡ªåŠ¨å­¦ä¹ ç¾¤ç»„ç‰¹å®šç”¨è¯­
"å‘è´¢äº†" â†’ "è¡¨ç¤ºæƒŠå–œæˆ–è·å¾—å¥½å¤„"
"ä¸‹æ¬¡ä¸€å®š" â†’ "å§”å©‰æ‹’ç»çš„è¡¨è¾¾"
"ğŸ¦Œ" â†’ "xxxxx"
```
- è‡ªåŠ¨æ£€æµ‹å€™é€‰é»‘è¯
- LLM æ™ºèƒ½æ¨æ–­å«ä¹‰
- å®æ—¶æ³¨å…¥å¯¹è¯ç†è§£

### ğŸ—ï¸ æ¶æ„ç‰¹æ€§

#### å·¥å‚æ¨¡å¼ (Factory Pattern)
```python
# ç»Ÿä¸€çš„æœåŠ¡åˆ›å»ºå’Œç®¡ç†
factory_manager = FactoryManager()
factory_manager.initialize_factories(config, context)

# æœåŠ¡å·¥å‚
service_factory = factory_manager.get_service_factory()
db_manager = service_factory.create_database_manager()

# ç»„ä»¶å·¥å‚
component_factory = factory_manager.get_component_factory()
expression_learner = component_factory.create_expression_pattern_learner()
```

#### ç­–ç•¥æ¨¡å¼ (Strategy Pattern)
```python
# çµæ´»çš„å­¦ä¹ ç­–ç•¥
learning_strategy = StrategyFactory.create_strategy(
    LearningStrategyType.BATCH,  # INCREMENTAL / REINFORCEMENT
    config={'batch_size': 100}
)
```

#### ä¾èµ–æ³¨å…¥ (Dependency Injection)
```python
# æœåŠ¡é—´æ¾è€¦åˆ
class MultidimensionalAnalyzer:
    def __init__(self, config, db_manager, llm_adapter, ...):
        self.config = config
        self.db = db_manager
        self.llm = llm_adapter
```

#### ä»“å‚¨æ¨¡å¼ (Repository Pattern)
```python
# æ•°æ®è®¿é—®å±‚æŠ½è±¡
affection_repo = AffectionRepository(session)
user_affection = await affection_repo.get_user_affection(group_id, user_id)
```

### ğŸ—„ï¸ å¤šæ•°æ®åº“æ”¯æŒ

```yaml
Database_Settings:
  db_type: "mysql"  # sqlite / mysql / postgresql(è¯¥åŠŸèƒ½æš‚æ—¶æ²¡æœ‰å¼€æ”¾ä½¿ç”¨)

  # MySQL é…ç½®
  mysql_host: "localhost"
  mysql_port: 3306
  mysql_user: "root"
  mysql_password: "your_password"
  mysql_database: "astrbot_self_learning"

  # è‡ªåŠ¨è¿æ¥æ± ç®¡ç†
  max_connections: 10
  min_connections: 2
```

æ”¯æŒçš„æ•°æ®åº“ï¼š
- **SQLite** - å¼€ç®±å³ç”¨ï¼Œé€‚åˆå•æœºéƒ¨ç½²
- **MySQL** - é«˜æ€§èƒ½ï¼Œé€‚åˆç”Ÿäº§ç¯å¢ƒ
- **PostgreSQL** - ä¼ä¸šçº§ï¼Œæ”¯æŒé«˜çº§ç‰¹æ€§

### ğŸ“Š æ•°æ®å¯è§†åŒ–

#### WebUI ç®¡ç†ç•Œé¢ (ç«¯å£: 7833)

**1. æ•°æ®ç»Ÿè®¡é¡µé¢**
![æ•°æ®ç»Ÿè®¡é¡µé¢](https://github.com/NickCharlie/astrbot_plugin_self_learning/blob/develop/image/%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1%E9%A1%B5%E9%9D%A2.png?raw=true)
- æ¶ˆæ¯æ”¶é›†ç»Ÿè®¡ã€å­¦ä¹ è¿›åº¦è·Ÿè¸ª
- ç³»ç»Ÿè¿è¡ŒçŠ¶æ€ã€æ•°æ®åº“ä½¿ç”¨æƒ…å†µ

**2. äººæ ¼ç®¡ç†é¡µé¢**
![äººæ ¼ç®¡ç†é¡µé¢](https://github.com/NickCharlie/astrbot_plugin_self_learning/blob/develop/image/%E4%BA%BA%E6%A0%BC%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2.png?raw=true)
- äººæ ¼åˆ—è¡¨æŸ¥çœ‹ã€ä¸€é”®åˆ‡æ¢
- äººæ ¼ç¼–è¾‘ã€å¤‡ä»½ä¸æ¢å¤
- è‡ªåŠ¨ä¿æŠ¤å½“å‰ä½¿ç”¨çš„äººæ ¼

**3. äººæ ¼å®¡æŸ¥é¡µé¢**
![äººæ ¼å®¡æŸ¥é¡µé¢](https://github.com/NickCharlie/astrbot_plugin_self_learning/blob/develop/image/%E4%BA%BA%E6%A0%BC%E5%AE%A1%E6%9F%A5%E9%A1%B5%E9%9D%A2.png?raw=true)
- å®¡æŸ¥ AI è‡ªåŠ¨ç”Ÿæˆçš„äººæ ¼æ›´æ–°å»ºè®®
- å¯¹æ¯”æ˜¾ç¤ºåŸå§‹å†…å®¹å’Œå»ºè®®ä¿®æ”¹
- æ‰¹å‡†æˆ–æ‹’ç»æ›´æ–°ï¼Œäººå·¥æŠŠå…³è´¨é‡

**4. é£æ ¼å­¦ä¹ é¡µé¢**
![å¯¹è¯é£æ ¼å­¦ä¹ é¡µé¢](https://github.com/NickCharlie/astrbot_plugin_self_learning/blob/develop/image/%E5%AF%B9%E8%AF%9D%E9%A3%8E%E6%A0%BC%E5%AD%A6%E4%B9%A0%E9%A1%B5%E9%9D%A2.png?raw=true)
- å­¦ä¹ è¿›åº¦å¯è§†åŒ–å›¾è¡¨
- åœºæ™¯-è¡¨è¾¾æ¨¡å¼æ˜ å°„å±•ç¤º
- è´¨é‡è¯„åˆ†å’Œæ—¶é—´è¡°å‡ç®¡ç†

**5. ç¤¾äº¤å…³ç³»åˆ†æé¡µé¢**
![ç¤¾äº¤å…³ç³»é¡µé¢](https://github.com/NickCharlie/astrbot_plugin_self_learning/blob/develop/image/%E7%A4%BE%E4%BA%A4%E5%85%B3%E7%B3%BB%E9%A1%B5%E9%9D%A2.png?raw=true)
- åŠ›å¯¼å‘å›¾å±•ç¤ºæˆå‘˜äº’åŠ¨å…³ç³»
- èŠ‚ç‚¹å¤§å°è¡¨ç¤ºæ´»è·ƒåº¦
- è¿çº¿ç²—ç»†è¡¨ç¤ºäº’åŠ¨é¢‘ç‡
- é¢œè‰²è¡¨ç¤ºå¥½æ„Ÿåº¦ç­‰çº§

**6. ç³»ç»Ÿè®¾ç½®é¡µé¢**
![é…ç½®é¡µé¢](https://github.com/NickCharlie/astrbot_plugin_self_learning/blob/develop/image/%E9%85%8D%E7%BD%AE%E9%A1%B5%E9%9D%A2.png?raw=true)
- å­¦ä¹ å‚æ•°é…ç½®
- æ¨¡å‹é…ç½®ç®¡ç†
- å¥½æ„Ÿåº¦å’Œæƒ…ç»ªç³»ç»Ÿå¼€å…³
- æ•°æ®ç®¡ç†å’Œè°ƒè¯•æ¨¡å¼

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå‡†å¤‡

```bash
# Python ç‰ˆæœ¬è¦æ±‚
Python 3.8+

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### å®‰è£…æ­¥éª¤

1. **å°†æ’ä»¶æ·»åŠ åˆ° AstrBot æ’ä»¶ç›®å½•**
   ```bash
   cd /path/to/astrbot/data/plugins
   git clone https://github.com/NickCharlie/astrbot_plugin_self_learning.git
   ```

2. **å¯åŠ¨ AstrBot**
   - æ’ä»¶å°†è‡ªåŠ¨åŠ è½½å¹¶åˆå§‹åŒ–

3. **è®¿é—® WebUI ç®¡ç†ç•Œé¢**
   ```
   http://localhost:7833
   ```
   - é»˜è®¤å¯†ç : `self_learning_pwd`
   - **âš ï¸ é¦–æ¬¡ç™»å½•ååŠ¡å¿…ä¿®æ”¹å¯†ç ï¼**

4. **é…ç½®æ’ä»¶**
   - åœ¨ AstrBot åå°æ’ä»¶ç®¡ç†ä¸­è®¾ç½®é…ç½®é¡¹
   - æˆ–é€šè¿‡ WebUI ç³»ç»Ÿè®¾ç½®é¡µé¢é…ç½®

### åŸºç¡€é…ç½®ç¤ºä¾‹

```yaml
# åŸºç¡€å¼€å…³
Self_Learning_Basic:
  enable_message_capture: true
  enable_auto_learning: true
  enable_realtime_learning: false
  enable_web_interface: true
  web_interface_port: 7833

# ç›®æ ‡è®¾ç½®
Target_Settings:
  target_qq_list: []  # ç•™ç©ºåˆ™å­¦ä¹ æ‰€æœ‰ç”¨æˆ·
  current_persona_name: "default"

# æ¨¡å‹é…ç½®
Model_Configuration:
  filter_provider_id: "provider_id_1"  # ç­›é€‰æ¨¡å‹
  refine_provider_id: "provider_id_2"  # æç‚¼æ¨¡å‹

# å­¦ä¹ å‚æ•°
Learning_Parameters:
  learning_interval_hours: 6
  min_messages_for_learning: 50
  max_messages_per_batch: 200

# æ•°æ®åº“é…ç½®
Database_Settings:
  db_type: "sqlite"  # æˆ– mysql / postgresql
```

---

## ğŸ›ï¸ æŠ€æœ¯æ¶æ„

### é¡¹ç›®ç»“æ„

```
astrbot_plugin_self_learning/
â”œâ”€â”€ core/                          # æ ¸å¿ƒæ¶æ„å±‚
â”‚   â”œâ”€â”€ factory.py                # å·¥å‚ç®¡ç†å™¨ï¼ˆä¾èµ–æ³¨å…¥å®¹å™¨ï¼‰
â”‚   â”œâ”€â”€ interfaces.py             # æ¥å£å®šä¹‰ï¼ˆæŠ½è±¡åŸºç±»ï¼‰
â”‚   â”œâ”€â”€ patterns.py               # è®¾è®¡æ¨¡å¼å®ç°ï¼ˆç­–ç•¥ã€è§‚å¯Ÿè€…ç­‰ï¼‰
â”‚   â”œâ”€â”€ framework_llm_adapter.py  # LLM æ¡†æ¶é€‚é…å™¨
â”‚   â””â”€â”€ database/                 # æ•°æ®åº“æŠ½è±¡å±‚
â”‚       â”œâ”€â”€ backend_interface.py  # æ•°æ®åº“æ¥å£
â”‚       â”œâ”€â”€ sqlite_backend.py     # SQLite å®ç°
â”‚       â”œâ”€â”€ mysql_backend.py      # MySQL å®ç°
â”‚       â””â”€â”€ postgresql_backend.py # PostgreSQL å®ç°
â”‚
â”œâ”€â”€ services/                      # æœåŠ¡å±‚ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
â”‚   â”œâ”€â”€ message_collector.py      # æ¶ˆæ¯æ”¶é›†æœåŠ¡
â”‚   â”œâ”€â”€ multidimensional_analyzer.py  # å¤šç»´åº¦åˆ†æ
â”‚   â”œâ”€â”€ style_analyzer.py         # é£æ ¼åˆ†ææœåŠ¡
â”‚   â”œâ”€â”€ progressive_learning.py   # æ¸è¿›å¼å­¦ä¹ æœåŠ¡
â”‚   â”œâ”€â”€ persona_manager.py        # äººæ ¼ç®¡ç†æœåŠ¡
â”‚   â”œâ”€â”€ expression_pattern_learner.py  # è¡¨è¾¾æ¨¡å¼å­¦ä¹ å™¨
â”‚   â”œâ”€â”€ affection_manager.py      # å¥½æ„Ÿåº¦ç®¡ç†æœåŠ¡
â”‚   â”œâ”€â”€ jargon_miner.py          # é»‘è¯æŒ–æ˜æœåŠ¡
â”‚   â”œâ”€â”€ jargon_query.py          # é»‘è¯æŸ¥è¯¢æœåŠ¡
â”‚   â”œâ”€â”€ social_context_injector.py  # ç¤¾äº¤ä¸Šä¸‹æ–‡æ³¨å…¥å™¨
â”‚   â””â”€â”€ response_diversity_manager.py  # å“åº”å¤šæ ·æ€§ç®¡ç†å™¨
â”‚
â”œâ”€â”€ models/                        # æ•°æ®æ¨¡å‹å±‚
â”‚   â””â”€â”€ orm/                      # ORM æ¨¡å‹ï¼ˆSQLAlchemyï¼‰
â”‚       â”œâ”€â”€ base.py               # åŸºç¡€æ¨¡å‹
â”‚       â”œâ”€â”€ expression.py         # è¡¨è¾¾æ¨¡å¼æ¨¡å‹
â”‚       â”œâ”€â”€ affection.py          # å¥½æ„Ÿåº¦æ¨¡å‹
â”‚       â”œâ”€â”€ learning.py           # å­¦ä¹ è®°å½•æ¨¡å‹
â”‚       â””â”€â”€ social_relation.py    # ç¤¾äº¤å…³ç³»æ¨¡å‹
â”‚
â”œâ”€â”€ repositories/                  # ä»“å‚¨å±‚ï¼ˆæ•°æ®è®¿é—®ï¼‰
â”‚   â”œâ”€â”€ base_repository.py        # åŸºç¡€ä»“å‚¨
â”‚   â”œâ”€â”€ expression_repository.py  # è¡¨è¾¾æ¨¡å¼ä»“å‚¨
â”‚   â”œâ”€â”€ affection_repository.py   # å¥½æ„Ÿåº¦ä»“å‚¨
â”‚   â””â”€â”€ social_repository.py      # ç¤¾äº¤å…³ç³»ä»“å‚¨
â”‚
â”œâ”€â”€ webui/                         # Web ç•Œé¢
â”‚   â”œâ”€â”€ app.py                    # Quart åº”ç”¨ä¸»å…¥å£
â”‚   â””â”€â”€ blueprints/               # è·¯ç”±è“å›¾
â”‚       â”œâ”€â”€ auth.py               # è®¤è¯è·¯ç”±
â”‚       â”œâ”€â”€ persona.py            # äººæ ¼ç®¡ç†è·¯ç”±
â”‚       â””â”€â”€ analytics.py          # æ•°æ®åˆ†æè·¯ç”±
â”‚
â”œâ”€â”€ utils/                         # å·¥å…·ç±»
â”‚   â”œâ”€â”€ cache_manager.py          # ç¼“å­˜ç®¡ç†
â”‚   â”œâ”€â”€ migration_tool_v2.py      # æ•°æ®åº“è¿ç§»å·¥å…·
â”‚   â””â”€â”€ security_utils.py         # å®‰å…¨å·¥å…·
â”‚
â”œâ”€â”€ config.py                      # é…ç½®ç®¡ç†
â”œâ”€â”€ main.py                        # æ’ä»¶ä¸»å…¥å£
â””â”€â”€ README.md                      # é¡¹ç›®æ–‡æ¡£
```

### æ ¸å¿ƒè®¾è®¡æ¨¡å¼

#### 1. å·¥å‚æ¨¡å¼ (Factory Pattern)

**ç›®çš„**: ç»Ÿä¸€ç®¡ç†æœåŠ¡åˆ›å»ºï¼Œé™ä½è€¦åˆ

```python
class FactoryManager:
    """å…¨å±€å·¥å‚ç®¡ç†å™¨ - å•ä¾‹æ¨¡å¼"""

    def initialize_factories(self, config, context):
        self._service_factory = ServiceFactory(config, context)
        self._component_factory = ComponentFactory(config, self._service_factory)

    def get_service_factory(self) -> ServiceFactory:
        # æœåŠ¡å·¥å‚ï¼šåˆ›å»ºä¸šåŠ¡æœåŠ¡ï¼ˆæ•°æ®åº“ã€å­¦ä¹ ã€åˆ†æç­‰ï¼‰
        return self._service_factory

    def get_component_factory(self) -> ComponentFactory:
        # ç»„ä»¶å·¥å‚ï¼šåˆ›å»ºè½»é‡çº§ç»„ä»¶ï¼ˆè¿‡æ»¤å™¨ã€è°ƒåº¦å™¨ç­‰ï¼‰
        return self._component_factory
```

**ä¼˜åŠ¿**:
- âœ… é›†ä¸­ç®¡ç†æœåŠ¡å®ä¾‹ï¼Œé¿å…å¾ªç¯ä¾èµ–
- âœ… æœåŠ¡ç¼“å­˜å’Œå•ä¾‹æ¨¡å¼ï¼Œæå‡æ€§èƒ½
- âœ… æ”¯æŒæœåŠ¡æ³¨å†Œå’Œä¾èµ–æ³¨å…¥

#### 2. ç­–ç•¥æ¨¡å¼ (Strategy Pattern)

**ç›®çš„**: çµæ´»åˆ‡æ¢å­¦ä¹ ç­–ç•¥

```python
class StrategyFactory:
    @staticmethod
    def create_strategy(strategy_type: LearningStrategyType, config: dict):
        strategies = {
            LearningStrategyType.BATCH: BatchLearningStrategy,
            LearningStrategyType.INCREMENTAL: IncrementalLearningStrategy,
            LearningStrategyType.REINFORCEMENT: ReinforcementLearningStrategy
        }
        return strategies[strategy_type](config)
```

**å­¦ä¹ ç­–ç•¥ç±»å‹**:
- **æ‰¹é‡å­¦ä¹ ** (Batch) - å®šæœŸæ‰¹é‡å¤„ç†æ¶ˆæ¯
- **å¢é‡å­¦ä¹ ** (Incremental) - å®æ—¶é€æ¡å­¦ä¹ 
- **å¼ºåŒ–å­¦ä¹ ** (Reinforcement) - åŸºäºåé¦ˆä¼˜åŒ–

#### 3. ä»“å‚¨æ¨¡å¼ (Repository Pattern)

**ç›®çš„**: æŠ½è±¡æ•°æ®è®¿é—®å±‚ï¼Œæ”¯æŒå¤šç§æ•°æ®åº“

```python
class BaseRepository:
    """åŸºç¡€ä»“å‚¨ - æä¾›é€šç”¨ CRUD æ“ä½œ"""

    async def get(self, id: int):
        async with self.session() as session:
            return await session.get(self.model, id)

    async def save(self, entity):
        async with self.session() as session:
            session.add(entity)
            await session.commit()

class ExpressionRepository(BaseRepository):
    """è¡¨è¾¾æ¨¡å¼ä»“å‚¨ - ä¸“é—¨å¤„ç†è¡¨è¾¾æ¨¡å¼æ•°æ®"""

    async def get_patterns_by_group(self, group_id: str, limit: int = 10):
        # ç‰¹å®šä¸šåŠ¡é€»è¾‘
        ...
```

#### 4. è§‚å¯Ÿè€…æ¨¡å¼ (Observer Pattern)

**ç›®çš„**: äº‹ä»¶é©±åŠ¨æ¶æ„ï¼Œè§£è€¦ç»„ä»¶

```python
class EventBus:
    """äº‹ä»¶æ€»çº¿ - å‘å¸ƒ/è®¢é˜…æ¨¡å¼"""

    def subscribe(self, event_type: str, handler: Callable):
        self._handlers[event_type].append(handler)

    async def publish(self, event_type: str, data: Any):
        for handler in self._handlers[event_type]:
            await handler(data)

# ä½¿ç”¨ç¤ºä¾‹
event_bus.subscribe("learning_completed", on_learning_completed)
await event_bus.publish("learning_completed", learning_result)
```

### æ•°æ®æµæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¶ˆæ¯æ¥æ”¶å±‚      â”‚  on_message() - ç›‘å¬æ‰€æœ‰æ¶ˆæ¯
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿‡æ»¤å™¨å±‚        â”‚  QQFilter + MessageFilter
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ•°æ®æ”¶é›†å±‚      â”‚  MessageCollector - å­˜å‚¨åŸå§‹æ¶ˆæ¯
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                  â”‚
         â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åˆ†æå±‚          â”‚  â”‚  å­¦ä¹ å±‚          â”‚
â”‚  - å¤šç»´åº¦åˆ†æ    â”‚  â”‚  - è¡¨è¾¾æ¨¡å¼å­¦ä¹   â”‚
â”‚  - é£æ ¼åˆ†æ      â”‚  â”‚  - é»‘è¯æŒ–æ˜      â”‚
â”‚  - ç¤¾äº¤å…³ç³»åˆ†æ  â”‚  â”‚  - è®°å¿†å›¾æ„å»º    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  äººæ ¼æ›´æ–°å±‚      â”‚
         â”‚  - PersonaUpdaterâ”‚
         â”‚  - å®¡æŸ¥æœºåˆ¶      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  LLMæ³¨å…¥å±‚       â”‚  inject_diversity_to_llm_request()
         â”‚  - è¡¨è¾¾æ¨¡å¼æ³¨å…¥  â”‚
         â”‚  - ç¤¾äº¤ä¸Šä¸‹æ–‡    â”‚
         â”‚  - é»‘è¯ç†è§£      â”‚
         â”‚  - å¤šæ ·æ€§å¢å¼º    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“– è¯¦ç»†åŠŸèƒ½è¯´æ˜

### è¡¨è¾¾æ¨¡å¼å­¦ä¹ ç³»ç»Ÿ

**å·¥ä½œåŸç†**:

1. **æ¶ˆæ¯æ”¶é›†** - æ¯æ”¶é›† 10-25 æ¡æ¶ˆæ¯è§¦å‘ä¸€æ¬¡å­¦ä¹ 
2. **åœºæ™¯è¯†åˆ«** - ä½¿ç”¨ LLM åˆ†æå¯¹è¯åœºæ™¯å’Œä¸Šä¸‹æ–‡
3. **è¡¨è¾¾æå–** - æå–ç›®æ ‡ç”¨æˆ·çš„ç‰¹å®šè¡¨è¾¾æ–¹å¼
4. **æ¨¡å¼å­˜å‚¨** - ä¿å­˜"åœºæ™¯â†’è¡¨è¾¾"æ˜ å°„å…³ç³»
5. **æ—¶é—´è¡°å‡** - 15å¤©è¡°å‡å‘¨æœŸï¼Œè´¨é‡åˆ†æ•°éšæ—¶é—´é™ä½
6. **Promptæ³¨å…¥** - å°†é«˜è´¨é‡æ¨¡å¼æ³¨å…¥ LLM è¯·æ±‚

**ç¤ºä¾‹**:
```
åœºæ™¯: "ç”¨æˆ·éœ€è¦è¡¨è¾¾èµåŒ"
è¡¨è¾¾: "ç¡®å®æ˜¯è¿™æ ·å‘¢"
è´¨é‡åˆ†æ•°: 0.85
åˆ›å»ºæ—¶é—´: 2025-11-20
è¡°å‡ååˆ†æ•°: 0.78 (5å¤©å)
```

### é»‘è¯æŒ–æ˜ç³»ç»Ÿ

**å·¥ä½œæµç¨‹**:

```python
# 1. å€™é€‰è¯æå–
candidates = await jargon_miner.extract_candidates(recent_messages)
# è¾“å‡º: ["å‘è´¢äº†", "ä¸‹æ¬¡ä¸€å®š", "çœŸé¦™"]

# 2. LLM æ¨æ–­å«ä¹‰
meanings = await jargon_miner.infer_meanings(candidates, context)
# è¾“å‡º: {
#   "å‘è´¢äº†": "è¡¨ç¤ºæƒŠå–œæˆ–è·å¾—å¥½å¤„",
#   "ä¸‹æ¬¡ä¸€å®š": "å§”å©‰æ‹’ç»çš„è¡¨è¾¾"
# }

# 3. ä¿å­˜åˆ°æ•°æ®åº“
await db.save_jargon_batch(chat_id, meanings)

# 4. LLM è¯·æ±‚æ—¶æ³¨å…¥ç†è§£
jargon_explanation = await jargon_query.check_and_explain_jargon(
    text="ä»Šå¤©çœŸæ˜¯å‘è´¢äº†ï¼",
    chat_id=group_id
)
# æ³¨å…¥åˆ° LLM prompt: "æ–‡æœ¬ä¸­åŒ…å«çš„é»‘è¯: ã€Œå‘è´¢äº†ã€: è¡¨ç¤ºæƒŠå–œæˆ–è·å¾—å¥½å¤„"
```

**ç‰¹ç‚¹**:
- âœ… è‡ªåŠ¨æ£€æµ‹é«˜é¢‘è¯æ±‡å’Œæ–°è¯
- âœ… ä¸Šä¸‹æ–‡ç†è§£ï¼Œç²¾å‡†æ¨æ–­å«ä¹‰
- âœ… 60ç§’ TTL ç¼“å­˜ï¼Œæå‡æ€§èƒ½
- âœ… å®æ—¶æ³¨å…¥ LLM ç†è§£ï¼Œé¿å…è¯¯è§£

### ç¤¾äº¤å…³ç³»åˆ†æ

**å…³ç³»è¿½è¸ª**:
```python
# è‡ªåŠ¨è®°å½•ç”¨æˆ·äº’åŠ¨
await social_relation_manager.record_interaction(
    group_id="123456",
    user_a="10001",
    user_b="10002",
    interaction_type="mention"  # at / reply / topic_discussion
)

# åˆ†æå…³ç³»å¼ºåº¦
strength = await social_relation_manager.calculate_relationship_strength(
    group_id, user_a, user_b
)
# è¾“å‡º: 0.75 (åŸºäºäº’åŠ¨é¢‘ç‡ã€ç±»å‹ã€æ—¶é—´è¡°å‡)
```

**å¥½æ„Ÿåº¦ç®¡ç†**:
```python
# å¤„ç†ç”¨æˆ·æ¶ˆæ¯äº’åŠ¨
result = await affection_manager.process_message_interaction(
    group_id, user_id, message_text
)

# è‡ªåŠ¨è¯†åˆ«äº’åŠ¨ç±»å‹
interaction_types = {
    "praise": +10,      # ç§°èµ
    "encourage": +5,    # é¼“åŠ±
    "insult": -15,      # ä¾®è¾±
    "harass": -20       # éªšæ‰°
}

# å¥½æ„Ÿåº¦é™åˆ¶
- å•ç”¨æˆ·ä¸Šé™: 100åˆ†
- ç¾¤ç»„æ€»åˆ†ä¸Šé™: 250åˆ†
- è¶…é¢æ—¶è‡ªåŠ¨è¡°å‡æ—§å¥½æ„Ÿåº¦
```

### äººæ ¼æ›´æ–°æœºåˆ¶

**ä¸¤ç§æ›´æ–°æ¨¡å¼**:

#### 1. PersonaManager æ¨¡å¼ (æ¨è)
```python
# ç›´æ¥åœ¨åŸäººæ ¼æœ«å°¾å¢é‡æ›´æ–°
await persona_manager_updater.apply_incremental_update(
    group_id=group_id,
    update_content="ã€å­¦ä¹ æˆæœã€‘\næ–°å¢è¡¨è¾¾æ¨¡å¼: ..."
)

# ä¼˜åŠ¿:
# âœ… è‡ªåŠ¨åˆ›å»ºå¤‡ä»½äººæ ¼
# âœ… æ— éœ€æ‰‹åŠ¨æ‰§è¡Œåº”ç”¨å‘½ä»¤
# âœ… æ›´å¥½çš„ç‰ˆæœ¬ç®¡ç†
```

#### 2. ä¼ ç»Ÿæ–‡ä»¶æ¨¡å¼
```python
# ä¸´æ—¶å­˜å‚¨åˆ° persona_updates.txt
await temporary_persona_updater.write_to_updates_file(content)

# æ‰‹åŠ¨å®¡æŸ¥ååº”ç”¨
/apply_persona_updates

# ä¼˜åŠ¿:
# âœ… äººå·¥å®¡æ ¸æŠŠå…³
# âœ… æ‰¹é‡åº”ç”¨æ›´æ–°
```

**äººæ ¼å®¡æŸ¥æµç¨‹**:
```
1. AI ç”Ÿæˆæ›´æ–°å»ºè®® â†’ ä¿å­˜åˆ° style_learning_reviews è¡¨
2. ç®¡ç†å‘˜ç™»å½• WebUI â†’ äººæ ¼å®¡æŸ¥é¡µé¢
3. æŸ¥çœ‹å¯¹æ¯”ï¼ˆåŸå§‹ vs å»ºè®®ï¼‰ â†’ çº¢è‰²é«˜äº®æ˜¾ç¤ºä¿®æ”¹
4. å†³ç­–ï¼šæ‰¹å‡† / æ‹’ç»
5. æ‰¹å‡†åè‡ªåŠ¨åº”ç”¨åˆ°äººæ ¼
```

---

## ğŸ“‹ å‘½ä»¤æ‰‹å†Œ

### åŸºç¡€å­¦ä¹ ç®¡ç†

| å‘½ä»¤ | æƒé™ | è¯´æ˜ |
|------|------|------|
| `/learning_status` | ç®¡ç†å‘˜ | æŸ¥çœ‹å­¦ä¹ çŠ¶æ€å’Œç»Ÿè®¡ä¿¡æ¯ |
| `/start_learning` | ç®¡ç†å‘˜ | æ‰‹åŠ¨å¯åŠ¨å­¦ä¹ æ‰¹æ¬¡ |
| `/stop_learning` | ç®¡ç†å‘˜ | åœæ­¢è‡ªåŠ¨å­¦ä¹ å¾ªç¯ |
| `/force_learning` | ç®¡ç†å‘˜ | å¼ºåˆ¶æ‰§è¡Œä¸€æ¬¡å­¦ä¹ å‘¨æœŸ |
| `/clear_data` | ç®¡ç†å‘˜ | æ¸…ç©ºæ‰€æœ‰å­¦ä¹ æ•°æ® (âš ï¸ä¸å¯é€†) |
| `/export_data` | ç®¡ç†å‘˜ | å¯¼å‡ºå­¦ä¹ æ•°æ®ä¸º JSON |

### å¥½æ„Ÿåº¦ç³»ç»Ÿ

| å‘½ä»¤ | æƒé™ | è¯´æ˜ |
|------|------|------|
| `/affection_status` | ç®¡ç†å‘˜ | æŸ¥çœ‹å¥½æ„Ÿåº¦çŠ¶æ€å’Œæ’è¡Œæ¦œ |
| `/set_mood <ç±»å‹>` | ç®¡ç†å‘˜ | è®¾ç½® Bot æƒ…ç»ªçŠ¶æ€ |

**æƒ…ç»ªç±»å‹**: `happy` `sad` `excited` `calm` `angry` `anxious` `playful` `serious` `nostalgic` `curious`

### äººæ ¼ç®¡ç†

| å‘½ä»¤ | æƒé™ | è¯´æ˜ |
|------|------|------|
| `/persona_switch <åç§°>` | ç®¡ç†å‘˜ | åˆ‡æ¢åˆ°æŒ‡å®šäººæ ¼ |
| `/persona_info` | ç®¡ç†å‘˜ | æ˜¾ç¤ºå½“å‰äººæ ¼è¯¦ç»†ä¿¡æ¯ |
| `/temp_persona apply` | ç®¡ç†å‘˜ | åº”ç”¨ä¸´æ—¶äººæ ¼ |
| `/temp_persona status` | ç®¡ç†å‘˜ | æŸ¥çœ‹ä¸´æ—¶äººæ ¼çŠ¶æ€ |
| `/temp_persona remove` | ç®¡ç†å‘˜ | ç§»é™¤ä¸´æ—¶äººæ ¼ |
| `/temp_persona extend [åˆ†é’Ÿ]` | ç®¡ç†å‘˜ | å»¶é•¿ä¸´æ—¶äººæ ¼æ—¶é—´ |
| `/temp_persona backup_list` | ç®¡ç†å‘˜ | åˆ—å‡ºæ‰€æœ‰å¤‡ä»½ |
| `/temp_persona restore <æ–‡ä»¶å>` | ç®¡ç†å‘˜ | ä»å¤‡ä»½æ¢å¤äººæ ¼ |

### é«˜çº§ç®¡ç†

| å‘½ä»¤ | æƒé™ | è¯´æ˜ |
|------|------|------|
| `/apply_persona_updates` | ç®¡ç†å‘˜ | åº”ç”¨ persona_updates.txt ä¸­çš„æ›´æ–° |
| `/switch_persona_update_mode` | ç®¡ç†å‘˜ | åˆ‡æ¢äººæ ¼æ›´æ–°æ–¹å¼ (manager/file) |
| `/clean_duplicate_content` | ç®¡ç†å‘˜ | æ¸…ç†é‡å¤çš„å†å²å†…å®¹ |
| `/analytics_report` | ç®¡ç†å‘˜ | ç”Ÿæˆæ•°æ®åˆ†ææŠ¥å‘Š |

---

## ğŸ”§ é…ç½®è¯¦è§£

### å®Œæ•´é…ç½®ç¤ºä¾‹

```yaml
# ========================================
# åŸºç¡€å¼€å…³
# ========================================
Self_Learning_Basic:
  enable_message_capture: true      # å¯ç”¨æ¶ˆæ¯æŠ“å–
  enable_auto_learning: true        # å¯ç”¨å®šæ—¶è‡ªåŠ¨å­¦ä¹ 
  enable_realtime_learning: false   # å¯ç”¨å®æ—¶å­¦ä¹ ï¼ˆæ¯æ¡æ¶ˆæ¯ï¼‰
  enable_web_interface: true        # å¯ç”¨ Web ç®¡ç†ç•Œé¢
  web_interface_port: 7833          # Web ç•Œé¢ç«¯å£

# ========================================
# ç›®æ ‡è®¾ç½®
# ========================================
Target_Settings:
  target_qq_list: []                # å­¦ä¹ ç›®æ ‡ QQ å·åˆ—è¡¨ï¼ˆç©º=å…¨éƒ¨ï¼‰
  target_blacklist: []              # å­¦ä¹ é»‘åå•
  current_persona_name: "default"   # å½“å‰äººæ ¼åç§°

# ========================================
# æ¨¡å‹é…ç½®ï¼ˆä½¿ç”¨ AstrBot Providerï¼‰
# ========================================
Model_Configuration:
  filter_provider_id: "provider_gpt4o_mini"  # ç­›é€‰æ¨¡å‹ï¼ˆå¼±æ¨¡å‹ï¼‰
  refine_provider_id: "provider_gpt4o"       # æç‚¼æ¨¡å‹ï¼ˆå¼ºæ¨¡å‹ï¼‰
  reinforce_provider_id: "provider_gpt4o"    # å¼ºåŒ–æ¨¡å‹

# ========================================
# å­¦ä¹ å‚æ•°
# ========================================
Learning_Parameters:
  learning_interval_hours: 6        # è‡ªåŠ¨å­¦ä¹ é—´éš”ï¼ˆå°æ—¶ï¼‰
  min_messages_for_learning: 50     # æœ€å°‘æ¶ˆæ¯æ•°æ‰å¼€å§‹å­¦ä¹ 
  max_messages_per_batch: 200       # æ¯æ‰¹å¤„ç†çš„æœ€å¤§æ¶ˆæ¯æ•°

# ========================================
# ç­›é€‰å‚æ•°
# ========================================
Filter_Parameters:
  message_min_length: 5             # æ¶ˆæ¯æœ€å°é•¿åº¦
  message_max_length: 500           # æ¶ˆæ¯æœ€å¤§é•¿åº¦
  confidence_threshold: 0.7         # ç­›é€‰ç½®ä¿¡åº¦é˜ˆå€¼
  relevance_threshold: 0.6          # ç›¸å…³æ€§é˜ˆå€¼

# ========================================
# é£æ ¼åˆ†æ
# ========================================
Style_Analysis:
  style_analysis_batch_size: 100    # é£æ ¼åˆ†ææ‰¹æ¬¡å¤§å°
  style_update_threshold: 0.6       # é£æ ¼æ›´æ–°é˜ˆå€¼

# ========================================
# å¥½æ„Ÿåº¦ç³»ç»Ÿ
# ========================================
Affection_System_Settings:
  enable_affection_system: true     # å¯ç”¨å¥½æ„Ÿåº¦ç³»ç»Ÿ
  max_total_affection: 250          # Bot æ€»å¥½æ„Ÿåº¦ä¸Šé™
  max_user_affection: 100           # å•ç”¨æˆ·å¥½æ„Ÿåº¦ä¸Šé™
  affection_decay_rate: 0.95        # å¥½æ„Ÿåº¦è¡°å‡æ¯”ä¾‹
  daily_mood_change: true           # å¯ç”¨æ¯æ—¥æƒ…ç»ªå˜åŒ–
  mood_affect_affection: true       # æƒ…ç»ªå½±å“å¥½æ„Ÿåº¦å˜åŒ–

# ========================================
# æƒ…ç»ªç³»ç»Ÿ
# ========================================
Mood_System_Settings:
  enable_daily_mood: true           # å¯ç”¨æ¯æ—¥æƒ…ç»ª
  enable_startup_random_mood: true  # å¯ç”¨å¯åŠ¨æ—¶éšæœºæƒ…ç»ª
  mood_change_hour: 6               # æƒ…ç»ªæ›´æ–°æ—¶é—´ï¼ˆ24å°æ—¶åˆ¶ï¼‰
  mood_persistence_hours: 24        # æƒ…ç»ªæŒç»­æ—¶é—´ï¼ˆå°æ—¶ï¼‰

# ========================================
# æ•°æ®åº“è®¾ç½®
# ========================================
Database_Settings:
  db_type: "sqlite"                 # æ•°æ®åº“ç±»å‹: sqlite / mysql / postgresql

  # MySQL é…ç½®ï¼ˆdb_type="mysql"æ—¶ç”Ÿæ•ˆï¼‰
  mysql_host: "localhost"
  mysql_port: 3306
  mysql_user: "root"
  mysql_password: "your_password"
  mysql_database: "astrbot_self_learning"

  # PostgreSQL é…ç½®ï¼ˆdb_type="postgresql"æ—¶ç”Ÿæ•ˆï¼‰
  postgresql_host: "localhost"
  postgresql_port: 5432
  postgresql_user: "postgres"
  postgresql_password: "your_password"
  postgresql_database: "astrbot_self_learning"
  postgresql_schema: "public"

  # è¿æ¥æ± é…ç½®
  max_connections: 10
  min_connections: 2

  # é‡æ„åŠŸèƒ½é…ç½®
  use_sqlalchemy: false             # ä½¿ç”¨ SQLAlchemy ORM
  use_enhanced_managers: false      # ä½¿ç”¨å¢å¼ºå‹ç®¡ç†å™¨

# ========================================
# ç¤¾äº¤ä¸Šä¸‹æ–‡è®¾ç½®
# ========================================
Social_Context_Settings:
  enable_social_context_injection: true  # å¯ç”¨ç¤¾äº¤å…³ç³»æ³¨å…¥
  include_social_relations: true         # æ³¨å…¥ç”¨æˆ·ç¤¾äº¤å…³ç³»
  include_affection_info: true           # æ³¨å…¥å¥½æ„Ÿåº¦ä¿¡æ¯
  include_mood_info: true                # æ³¨å…¥ Bot æƒ…ç»ªä¿¡æ¯
  context_injection_position: "start"    # æ³¨å…¥ä½ç½®: start / end

# ========================================
# é«˜çº§è®¾ç½®
# ========================================
Advanced_Settings:
  debug_mode: false                 # è°ƒè¯•æ¨¡å¼
  save_raw_messages: true           # ä¿å­˜åŸå§‹æ¶ˆæ¯
  auto_backup_interval_days: 7      # è‡ªåŠ¨å¤‡ä»½é—´éš”ï¼ˆå¤©ï¼‰
  use_enhanced_managers: false      # ä½¿ç”¨å¢å¼ºå‹ç®¡ç†å™¨
  enable_memory_cleanup: true       # å¯ç”¨è®°å¿†è‡ªåŠ¨æ¸…ç†
  memory_cleanup_days: 30           # è®°å¿†ä¿ç•™å¤©æ•°
  memory_importance_threshold: 0.3  # è®°å¿†é‡è¦æ€§é˜ˆå€¼

# ========================================
# å­˜å‚¨è®¾ç½®
# ========================================
Storage_Settings:
  data_dir: "./data/self_learning_data"  # æ•°æ®å­˜å‚¨ç›®å½•
```

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### AI/ML æŠ€æœ¯æ ˆ
- **å¤§å‹è¯­è¨€æ¨¡å‹**: OpenAI GPTç³»åˆ—ã€å…¼å®¹ OpenAI API çš„ä»»æ„æ¨¡å‹
- **æœºå™¨å­¦ä¹ **: `scikit-learn` `numpy` `pandas`
- **æƒ…æ„Ÿè®¡ç®—**: æƒ…ç»ªè¯†åˆ«ã€æƒ…æ„ŸçŠ¶æ€å»ºæ¨¡
- **çŸ¥è¯†å›¾è°±**: `networkx` - å…³ç³»ç½‘ç»œåˆ†æ
- **è‡ªç„¶è¯­è¨€å¤„ç†**: `jieba` - ä¸­æ–‡åˆ†è¯

### æ•°æ®å¯è§†åŒ–
- **å›¾è¡¨ç”Ÿæˆ**: `plotly` `matplotlib` `seaborn`
- **ç½‘ç»œå¯è§†åŒ–**: `bokeh` - ç¤¾äº¤å…³ç³»å›¾
- **æ•°æ®åˆ†æ**: å¤šç»´åº¦ç»Ÿè®¡åˆ†æ

### ç³»ç»Ÿæ¶æ„
- **å¼‚æ­¥æ¡†æ¶**: `asyncio` `aiohttp` `aiofiles`
- **æ•°æ®åº“**: `aiosqlite` `aiomysql` `asyncpg` + `SQLAlchemy[asyncio]`
- **Webæ¡†æ¶**: `quart` `quart-cors` - å¼‚æ­¥ Flask-like æ¡†æ¶
- **ç¼“å­˜ç³»ç»Ÿ**: `cachetools` - TTLç¼“å­˜
- **ä»»åŠ¡è°ƒåº¦**: `apscheduler` - å®šæ—¶ä»»åŠ¡

### å¼€å‘å·¥å…·
- **æ•°æ®åº“è¿ç§»**: `alembic` - SQLAlchemy è¿ç§»å·¥å…·
- **å®‰å…¨å·¥å…·**: `guardrails-ai` - LLM è¾“å‡ºæ ¡éªŒ
- **æµ‹è¯•æ¡†æ¶**: `pytest` `pytest-asyncio`

---

## ğŸ“š æ–‡æ¡£å¯¼èˆª

### ç”¨æˆ·æ–‡æ¡£
- [å¿«é€Ÿå¼€å§‹æŒ‡å—](#-å¿«é€Ÿå¼€å§‹)
- [WebUI ä½¿ç”¨æ•™ç¨‹](#-æ•°æ®å¯è§†åŒ–)
- [å‘½ä»¤æ‰‹å†Œ](#-å‘½ä»¤æ‰‹å†Œ)
- [é…ç½®è¯¦è§£](#-é…ç½®è¯¦è§£)

### å¼€å‘æ–‡æ¡£
- [æ¶æ„è®¾è®¡](#-æŠ€æœ¯æ¶æ„)
- [è®¾è®¡æ¨¡å¼è¯¦è§£](#æ ¸å¿ƒè®¾è®¡æ¨¡å¼)
- [æ•°æ®åº“è¿ç§»å·¥å…·](utils/migration_tool_v2.py)
- [API æ¥å£æ–‡æ¡£](webui/README.md)

### è¿›é˜¶æ–‡æ¡£
- [è¡¨è¾¾æ¨¡å¼å­¦ä¹ åŸç†](#è¡¨è¾¾æ¨¡å¼å­¦ä¹ ç³»ç»Ÿ)
- [é»‘è¯æŒ–æ˜ç®—æ³•](#é»‘è¯æŒ–æ˜ç³»ç»Ÿ)
- [ç¤¾äº¤å…³ç³»åˆ†æ](#ç¤¾äº¤å…³ç³»åˆ†æ)
- [äººæ ¼æ›´æ–°æœºåˆ¶](#äººæ ¼æ›´æ–°æœºåˆ¶)

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿å¼€å‘è€…å‚ä¸é¡¹ç›®å»ºè®¾ï¼

### è´¡çŒ®æ–¹å¼
1. **Bug åé¦ˆ** - [æäº¤ Issue](https://github.com/NickCharlie/astrbot_plugin_self_learning/issues)
2. **åŠŸèƒ½å»ºè®®** - [Feature Request](https://github.com/NickCharlie/astrbot_plugin_self_learning/issues/new?template=feature_request.md)
3. **ä»£ç è´¡çŒ®** - Fork é¡¹ç›®å¹¶æäº¤ Pull Request
4. **æ–‡æ¡£æ”¹è¿›** - å®Œå–„æ–‡æ¡£å’Œæ•™ç¨‹

### å¼€å‘è§„èŒƒ
- éµå¾ªç°æœ‰çš„æ¶æ„è®¾è®¡å’Œè®¾è®¡æ¨¡å¼
- ä½¿ç”¨å·¥å‚æ¨¡å¼ç»Ÿä¸€ç®¡ç†æœåŠ¡
- ä¼˜å…ˆä½¿ç”¨ä¾èµ–æ³¨å…¥ï¼Œé¿å…ç¡¬ç¼–ç 
- æ¯ä¸ªåŠŸèƒ½åˆ†æ–‡ä»¶ï¼Œæ¯ä¸ªæ¨¡å—åˆ†ç›®å½•
- å¯¼å…¥è‡ªå·±çš„æ¨¡å—æ—¶ä½¿ç”¨ç›¸å¯¹å¯¼å…¥
- æ·»åŠ å•å…ƒæµ‹è¯•è¦†ç›–æ ¸å¿ƒé€»è¾‘

---

## ğŸ“„ å¼€æºåè®®

æœ¬é¡¹ç›®é‡‡ç”¨ [GPLv3 License](LICENSE) å¼€æºåè®®ã€‚

### è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹é¡¹ç›®çš„å¯å‘å’Œæ”¯æŒï¼š

- **[MaiBot](https://github.com/Mai-with-u/MaiBot)** - è¡¨è¾¾æ¨¡å¼å­¦ä¹ ã€æ—¶é—´è¡°å‡æœºåˆ¶ã€çŸ¥è¯†å›¾è°±ç®¡ç†ç­‰æ ¸å¿ƒè®¾è®¡æ€è·¯
- **[AstrBot](https://github.com/Soulter/AstrBot)** - ä¼˜ç§€çš„èŠå¤©æœºå™¨äººæ¡†æ¶

---

## âš ï¸ å…è´£å£°æ˜

1. **æ•°æ®å®‰å…¨**:
   - æ‰€æœ‰å­¦ä¹ æ•°æ®æœ¬åœ°åŒ–å­˜å‚¨
   - è¯·å®šæœŸå¤‡ä»½æ•°æ®åº“å’Œäººæ ¼æ–‡ä»¶
   - å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¿®æ”¹ WebUI é»˜è®¤å¯†ç 

2. **ä½¿ç”¨é£é™©**:
   - æ’ä»¶ç›®å‰å¤„äºæµ‹è¯•é˜¶æ®µï¼Œå¯èƒ½å­˜åœ¨æœªçŸ¥ Bug
   - ä½¿ç”¨å‰è¯·åŠ¡å¿…å¤‡ä»½äººæ ¼æ–‡ä»¶
   - å­¦ä¹ è´¨é‡å–å†³äºå­¦ä¹ æ ·æœ¬è´¨é‡

3. **éšç§ä¿æŠ¤**:
   - æ’ä»¶ä¼šæ”¶é›†å’Œåˆ†æç”¨æˆ·æ¶ˆæ¯
   - è¯·éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ï¼Œå°Šé‡ç”¨æˆ·éšç§
   - ä¸å»ºè®®åœ¨å…¬å¼€ç¯å¢ƒæš´éœ² WebUI ç«¯å£

---

## ğŸ¯ æœªæ¥è®¡åˆ’

### å³å°†æ¨å‡º
- [ ] çŸ¥è¯†å›¾è°±å’Œé•¿æœŸè®°å¿†ç³»ç»Ÿï¼ˆç†è§£ä¸Šä¸‹æ–‡å…³ç³»ï¼Œå»ºç«‹æŒä¹…è®°å¿†ï¼‰
- [ ] å¤šäººæ ¼è‡ªåŠ¨åˆ‡æ¢ï¼ˆæ ¹æ®å¯¹è¯åœºæ™¯ï¼‰
- [ ] é«˜çº§æƒ…ç»ªå»ºæ¨¡ï¼ˆæƒ…ç»ªé“¾å’Œæƒ…ç»ªè½¬ç§»ï¼‰
- [ ] å¼ºåŒ–å­¦ä¹ ä¼˜åŒ–ï¼ˆåŸºäºç”¨æˆ·åé¦ˆï¼‰
- [ ] å¤šæ¨¡æ€å­¦ä¹ æ”¯æŒï¼ˆå›¾ç‰‡ã€è¯­éŸ³ï¼‰

### é•¿æœŸè§„åˆ’
- [ ] è”é‚¦å­¦ä¹ ï¼ˆè·¨ç¾¤ç»„çŸ¥è¯†å…±äº«ï¼‰
- [ ] è‡ªä¸»å¯¹è¯å‘èµ·ï¼ˆä¸»åŠ¨è¯é¢˜å¼•å¯¼ï¼‰

---

<div align="center">

**æ„Ÿè°¢ä½¿ç”¨ AstrBot æ™ºèƒ½è‡ªä¸»å­¦ä¹ æ’ä»¶ï¼**

å¦‚æœè§‰å¾—æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ â­Star æ”¯æŒï¼

[å›åˆ°é¡¶éƒ¨](#astrbot-æ™ºèƒ½è‡ªä¸»å­¦ä¹ æ’ä»¶-next-gen-)

</div>
